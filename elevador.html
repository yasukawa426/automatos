<!DOCTYPE html>
<html lang="en">
  <style>
    body,
    html {
      height: 100%;
    }
    body {
      /* Full height */
      height: 100%;

      /* Center and scale the image nicely */
      background-position: center;
      background-repeat: no-repeat;
      background-size: contain;
      background-size: 50% 100vh;
      background-color: rgb(153, 154, 158);
    }

    #subir,
    #descer,
    #fechar,
    #botao_musica {
      position: absolute;
      left: 70%;
    }

    #subir,
    #descer,
    #fechar,
    #botao_musica {
      border-radius: 200%;
    }

    #subir {
      top: 50%;
    }

    #descer {
      top: 55%;
    }

    #fechar {
      top: 60%;
    }

    #botao_musica {
      top: 10%;
    }

    #andar {
      position: absolute;
      left: 50%;
      top: 10.6%;
      font-family: "Elevator";
      color: green;
      font-weight: bold;
      font-size: 160%;
    }

    @font-face {
      font-family: elevator;
      src: url("font/elevador/Elevator.eot") format("embedded-opentype"),
        /* IE6-IE8 */ url("font/elevador/Elevator.woff2") format("woff2"),
        /* Super Modern Browsers */ url("font/elevador/Elevator.woff")
          format("woff"),
        /* Pretty Modern Browsers */ url("font/elevador/Elevator.ttf")
          format("truetype"),
        /* Safari, Android, iOS */ url("font/elevador/Elevator.svg")
          format("svg"); /* Legacy iOS */
    }

    .circulo {
      width: 6%;
      border-radius: 50%;
      background: yellow;
      left: 8%;
      line-height: 0;
      position: relative;
    }

    .circulo2 {
      position: absolute;
      top: 18.5%;
      width: 6%;
      border-radius: 50%;
      background: yellow;
      left: 8%;
      line-height: 0;
      position: relative;
    }

    .circulo2::after {
      content: "";
      display: block;
      padding-bottom: 100%;
    }

    /* (B) USE ::AFTER TO CREATE MATCHING HEIGHT */
    /* Credits - https://spin.atomicobject.com/2015/07/14/css-responsive-square/ */
    .circulo::after {
      content: "";
      display: block;
      padding-bottom: 100%;
    }

    .circulo-txt {
      /* (E1) CENTER TEXT IN CIRCLE */
      position: absolute;
      bottom: 50%;
      width: 100%;
      text-align: center;

      font-family: arial, sans-serif;
      font-weight: bold;
    }

    .linha {
      position: absolute;
      left: 11%;
      border-left: 2px solid black;
      height: 19%;
    }

    .simbolo {
      position: absolute;
      top: 40%;
      left: 13%;
      font-size: 130%;
    }

    #seta {
      font-size: 160%;
      position: absolute;
      left: 10.4%;
      top: 46.2%;
      display: none;
    }
  </style>
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Case 2 - Elevador</title>
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi"
      crossorigin="anonymous"
    />
  </head>
  <!-- navbar -->
  <body id="fundo">
    <nav class="navbar navbar-expand-lg bg-light">
      <div class="container-fluid">
        <a class="navbar-brand" href="#">Autômatos:</a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
          aria-controls="navbarNav"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <div class="navbar-nav">
            <a href="maquina_doces.html" class="nav-link"
              >Case 1 (Máquina de Doces)</a
            >
            <a href="elevador.html" class="nav-link active"
              >Case 2 (Elevador)</a
            >
          </div>
        </div>
      </div>
    </nav>

    <!-- botoes -->
    <p id="andar"></p>
    <button type="button" id="subir" class="medium material-icons">
      arrow_upward
    </button>
    <button type="button" id="descer" class="medium material-icons">
      arrow_downward
    </button>
    <button type="button" id="fechar" class="medium material-icons">
      compare_arrows
    </button>

    <button type="button" class="medium material-icons" id="botao_musica">
      volume_up
    </button>

    <!--abrir modal -->
    <button
      type="button"
      class="btn btn-primary"
      data-bs-toggle="modal"
      data-bs-target="#exampleModal"
    >
      Ver autômato completo
    </button>

    <p></p>

    <p>Representação dos movimento:</p>
    <!-- desenho do automato -->
    <div class="circulo" id="circulo">
      <div class="circulo-txt" id="primeiroTexto"></div>
    </div>
    <!-- linha -->
    <div class="linha" id="linha"></div>
    <span class="simbolo" id="simbolo"></span>

    <div class="circulo2" id="circulo2">
      <div class="circulo-txt" id="segundoTexto"></div>
    </div>

    <span id="seta">\/</span>

    <!-- Modal -->
    <div
      class="modal fade"
      id="exampleModal"
      tabindex="-1"
      aria-labelledby="exampleModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="exampleModalLabel">
              Case 2 - Elevador
            </h1>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <p><b>Símbolos:</b> "s" (subir), "d" (descer), "f" (fechar)</p>
            <p>
              <b>Estados:</b> "T" (térreo), "P1" (piso 1), "P2", "P3", "TA"
              (térreo aberto), "P1A" (piso 1 aberto), "P2A", "P3A"
            </p>
            <img
              src="animation/elevador/elevador_automato.png"
              style="
                height: 80%;
                width: 80%;
                display: block;
                margin-left: auto;
                margin-right: auto;
              "
            />
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Fechar
            </button>
          </div>
        </div>
      </div>
    </div>
  </body>

  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3"
    crossorigin="anonymous"
  ></script>
  <script>
    //elementos
    var fundo = document.getElementById("fundo");
    var botaoSubir = document.getElementById("subir");
    var botaoDescer = document.getElementById("descer");
    var botaoFechar = document.getElementById("fechar");
    var botaoMusica = document.getElementById("botao_musica");
    var textoAndar = document.getElementById("andar");

    var primeiroTexto = document.getElementById("primeiroTexto");
    var segundoTexto = document.getElementById("segundoTexto");
    var circulo = document.getElementById("circulo");
    var circuloDois = document.getElementById("circulo2");
    var simbolo = document.getElementById("simbolo");
    var linha = document.getElementById("linha");
    var seta = document.getElementById("seta");

    //imagens
    var imagemFechada = "animation/elevador/elevador_fechado.jpg";
    var imagemAberta = "animation/elevador/elevador_aberto.jpg";
    var imagemFechando = "animation/elevador/elevador_fechando.jpg";
    var imagemSubindo = "animation/elevador/elevador_subindo.jpg";
    var imagemDescendo = "animation/elevador/elevador_descendo.jpg";

    localStorage.clear();
    localStorage.setItem("andar", "T");
    localStorage.setItem("aberto", "true");

    primeiroTexto.innerText = "TA";

    textoAndar.innerText = localStorage.getItem("andar");
    fundo.background = "animation/elevador/elevador_aberto.jpg";

    var audio = new Audio("audio/elevador/elevator_music.wav");
    audio.volume = 0.3;

    // Fecha ou abre a porta. Troca a imagem de fundo, espera 500ms e troca novamente. atualiza os textos das bolinha com "Andar" e "Andar + A" e vice e versa. Toca um som ao abrir.
    botaoFechar.onclick = async function () {
      seta.style.display = "flex";
      simbolo.innerHTML = "f";
      if (localStorage.getItem("aberto") == "true") {
        fundo.background = imagemFechando;
        primeiroTexto.innerHTML = localStorage.getItem("andar") + "A";
        segundoTexto.innerHTML = localStorage.getItem("andar");
        textoAndar.innerText = localStorage.getItem("andar");
        localStorage.setItem("aberto", "false");
        await new Promise((r) => setTimeout(r, 500));
        fundo.background = imagemFechada;
      } else {
        var audio = new Audio("audio/elevador/ding.wav");
        audio.play();
        fundo.background = imagemFechando;
        primeiroTexto.innerHTML = localStorage.getItem("andar");
        segundoTexto.innerHTML = localStorage.getItem("andar") + "A";

        textoAndar.innerText = localStorage.getItem("andar");
        localStorage.setItem("aberto", "true");
        await new Promise((r) => setTimeout(r, 500));
        fundo.background = imagemAberta;
      }
    };

    //Sobe o elevador. Altera a imagem. Salva o andar atual. E preenche as bolinhas com o andar anterior e o atual.
    botaoSubir.onclick = async function () {
      simbolo.innerHTML = "s";
      seta.style.display = "flex";

      andar = localStorage.getItem("andar");
      if (localStorage.getItem("aberto") == "true") {
        primeiroTexto.innerHTML = andar;
        segundoTexto.innerHTML = andar;
      } else {
        fundo.background = imagemSubindo;
        switch (andar) {
          case "T":
            andar = "1";
            primeiroTexto.innerHTML = "T";
            segundoTexto.innerHTML = "1";
            break;

          case "1":
            andar = "2";
            primeiroTexto.innerHTML = "1";
            segundoTexto.innerHTML = "2";
            break;

          case "2":
            andar = "3";
            primeiroTexto.innerHTML = "2";
            segundoTexto.innerHTML = "3";
            break;

          case "3":
            andar = "3";
            primeiroTexto.innerHTML = "3";
            segundoTexto.innerHTML = "3";
            break;

          default:
            break;
        }
        textoAndar.innerText = andar;
        localStorage.setItem("andar", andar);
      }
    };

    //Fecha o elevador. Altera a imagem. Salva o andar atual. E preenche as bolinhas com o andar anterior e o atual.
    botaoDescer.onclick = async function () {
      simbolo.innerHTML = "d";
      seta.style.display = "flex";
      andar = localStorage.getItem("andar");

      if (localStorage.getItem("aberto") == "true") {
        primeiroTexto.innerHTML = andar;
        segundoTexto.innerHTML = andar;
      } else {
        fundo.background = imagemDescendo;

        switch (andar) {
          case "T":
            andar = "T";
            primeiroTexto.innerHTML = "T";
            segundoTexto.innerHTML = "T";
            break;

          case "1":
            andar = "T";
            primeiroTexto.innerHTML = "1";
            segundoTexto.innerHTML = "T";
            break;

          case "2":
            andar = "1";
            primeiroTexto.innerHTML = "2";
            segundoTexto.innerHTML = "1";
            break;

          case "3":
            andar = "2";
            primeiroTexto.innerHTML = "3";
            segundoTexto.innerHTML = "2";
            break;

          default:
            break;
        }
        textoAndar.innerText = andar;
        localStorage.setItem("andar", andar);
      }
    };
    botaoMusica.onclick = function () {
      if (audio.paused) {
        botaoMusica.innerHTML = "volume_off";
        if (typeof audio.loop == "boolean") {
          audio.loop = true;
        } else {
          audio.addEventListener(
            "ended",
            function () {
              this.currentTime = 0;
              this.play();
            },
            false
          );
        }
        audio.play();
      } else if (audio.paused == false) {
        botaoMusica.innerHTML = "volume_up";
        document.querySelectorAll("audio").forEach((el) => el.pause());
        audio.pause();
        audio.currentTime = 0;
      }
    };
  </script>
</html>
